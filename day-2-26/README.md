# 类型检查机制

类型检查机制：TS 编译器在做类型检查时，所秉承的一些原则，以及表现出的一些行为

作用：辅助开发，提高开发效率

## 类型推断

不需要指定变量类型（函数的返回值类型），TS 可以根据某些规则自动地为其推断出一个类型

- 基础类型推断
- 最佳通用类型推断。有多种类型存在时，推断出一种能兼容所有候选类型的类型
- 上下文类型推断。根据上下文信息做类型推断

如果你不相信 TS 的类型推断，你也可以做类型断言，但不要滥用，要充分清楚情况再去断言，避免引入歧义的代码。

## 类型兼容性

当一个类型 Y 可以赋值给另一个类型 X 时，就可以说类型 X 兼容类型 Y

X 兼容 Y： X(目标类型) = Y(源类型)

兼容的原则是：鸭式辩型法

- 接口兼容性：成员少的兼容成员多的
- 函数兼容性
  - 参数个数
  - 参数类型
  - 返回值类型
- 枚举兼容性
- 类兼容性

口诀：

- 结构直接兼容：成员多的兼容成员少的
- 函数之间兼容：参数多的兼容参数少的

## 类型保护

TS 能够在特定的区块中保证变量属于某种确定的类型，可以放心在此区块中引用此类型的属性，或者调用此类型的方法。

- instanceof。直接判断实例是否是某个具体的类型
- in。在对象中有某个特定成员的时候可以用这个方法
- typeof。一般用联合的原始类型的类型保护
- 还有一种方式是创建一个类型保护函数，需要用到类型谓词 `is`
